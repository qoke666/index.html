<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TMA Главная</title>
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap');

    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: #080808;
      color: #ffffff;
      overflow-y: auto;
      position: relative;
    }
    #tsparticles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }
    a { text-decoration: none; }
    ul { list-style: none; margin: 0; padding: 0; }

    .menu-top { display: flex; justify-content: flex-start; align-items: center; padding: 16px; }
    .menu-top .logo { width: 100px; }

    .carousel {
      position: relative;
      width: 343px;
      height: 136px;
      margin: 0 auto;
      border-radius: 12px;
      overflow: hidden;
      background: #000;
      max-width: 100%;
    }
    .carousel a {
      display: block;
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      opacity: 0;
      transition: opacity .5s, transform .5s;
      transform: scale(1);
    }
    .carousel a.active {
      opacity: 1;
      z-index: 1;
      transform: scale(1.02);
    }
    .carousel img { width: 100%; height: 100%; object-fit: cover; display: block; }
    .carousel .hot {
      position: absolute;
      top: 8px;
      left: 16px;
      font-size: 20px;
      font-weight: 500;
      color: #ffffff;
      z-index: 2;
    }
    .carousel-dots {
      position: absolute;
      bottom: 8px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 5px;
      z-index: 2;
    }
    .carousel-dots .dot {
      width: 5px;
      height: 5px;
      border-radius: 50%;
      background: rgba(255,255,255,0.3);
      cursor: pointer;
      transition: background .3s;
    }
    .carousel-dots .dot.active { background: #d5fd02; }

    .menu {
      display: flex;
      justify-content: center;
      background: #080808;
      padding: 12px 0;
      position: sticky;
      top: 0;
      z-index: 10;
      max-width: 100%;
    }
    .menu ul {
      display: inline-flex;
      gap: 10px;
      padding: 0 16px;
      overflow-x: auto;
      white-space: nowrap;
      scroll-behavior: smooth;
      touch-action: pan-x;
      -webkit-overflow-scrolling: touch;
    }
    .menu ul::-webkit-scrollbar { display: none; }
    .menu-item {
      padding: 6px 12px;
      border-radius: 6px;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      color: #ccc;
      transition: background .3s, color .3s;
    }
    .menu-item.active, .menu-item:hover {
      background: #d5fd02;
      color: #080808;
    }

    .section {
      display: none;
      padding: 24px 16px;
      box-sizing: border-box;
      min-height: 100px; /* Предотвращаем схлопывание */
    }
    .section.active {
      display: block;
      opacity: 1;
    }

    .section-title {
      font-size: 24px;
      font-weight: 600;
      margin: 24px 0;
      color: #d5fd02;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
      min-height: 100px;
    }
    .card {
      background: #111315;
      border: 1px solid #222;
      border-radius: 12px;
      color: #ccc;
      transition: transform .2s, box-shadow .2s;
      position: relative;
      overflow: hidden;
      min-height: 140px; /* Гарантируем видимость */
    }
    .card:hover {
  transform: scale(1.02); /* Из исходного кода */
  box-shadow: 0 4px 12px rgba(213, 253, 2, 0.2); /* добавил */
}
#home .card, #articles .card, #cases .card {
  width: 100%;
  height: 105px; /* Уменьшенная высота для 4:3 */
  overflow: hidden;
  background: #111315; /* Фон для пустых областей */
  aspect-ratio: 4 / 3; /* Пропорции 640x480px */
}
#home .actual-item {
  flex: 0 0 140px; /* Ширина для скролла */
  height: 105px; /* Соответствует .card */
}
#home .actual-item .card {
  width: 100%;
  height: 105px;
  background: #111315;
}
#home .card img, #articles .card img, #cases .card img, #home .actual-item .card img {
  width: 100%;
  height: 105px; /* Уменьшенная высота */
  object-fit: cover; /* Заполняет без полос */
  display: block;
  border-radius: 12px;
}
    #vacancies .card, #offers .card {
      padding: 8px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      cursor: pointer;
    }
    .card .text-overlay {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(0,0,0,0.7);
      padding: 6px;
      z-index: 2;
    }
    .card strong {
      display: block;
      font-size: 13px;
      color: #ffffff;
      margin-bottom: 4px;
    }
    .card p {
      font-size: 11px;
      color: #bbb;
      margin: 0;
    }
    #vacancies .promo-card {
      grid-column: 1 / -1;
      background: #1a1d21;
      padding: 12px;
      text-align: center;
      font-size: 15px;
      font-weight: 600;
      color: #d5fd02;
      border-radius: 12px;
      cursor: pointer;
    }
    #vacancies .promo-card:hover {
      transform: scale(1.02);
      box-shadow: 0 4px 12px rgba(213, 253, 2, 0.2);
    }

    .team-carousel, .actual-list-container {
      margin: 16px 0;
      max-width: 100%;
      overflow: hidden;
      position: relative;
    }
    .team-list, .actual-list {
      display: inline-flex;
      gap: 12px;
      padding: 0 16px;
      overflow-x: auto;
      white-space: nowrap;
      scroll-behavior: smooth;
      touch-action: pan-x;
      -webkit-overflow-scrolling: touch;
      width: 100%;
      box-sizing: border-box;
    }
    .team-list::-webkit-scrollbar, .actual-list::-webkit-scrollbar { display: none; }
    .team-item {
      flex: 0 0 140px;
      padding: 8px;
      text-align: center;
      transition: transform .2s;
    }
    .team-item:hover { transform: scale(1.02); }
    .team-item img {
      width: 50px;
      height: 50px;
      object-fit: cover;
      border-radius: 50%;
      margin: 0 auto 8px;
      display: block;
    }
    .team-item strong {
      display: block;
      font-size: 13px;
      color: #ffffff;
      margin-bottom: 4px;
    }
    .team-item p {
      font-size: 11px;
      color: #bbb;
      margin: 0;
    }
    .actual-item { flex: 0 0 140px; }
    .actual-item .card {
      border-radius: 12px;
      overflow: hidden;
      display: block;
    }
    .actual-item .card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 12px;
    }
    #offers .card {
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    #offers .card strong {
      font-size: 15px;
      color: #d5fd02;
    }
    #offers .card p {
      font-size: 13px;
      color: #ccc;
      margin: 0;
      line-height: 1.4;
    }
    .modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.8);
      background: #111315;
      border: 1px solid #222;
      border-radius: 12px;
      padding: 24px;
      z-index: 9999;
      color: #fff;
      max-width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      box-sizing: border-box;
      opacity: 0;
      transition: transform .3s ease, opacity .3s ease;
    }
    .modal.active {
      transform: translate(-50%, -50%) scale(1);
      opacity: 1;
    }
    .modal h3 {
      margin: 0 0 12px;
      color: #d5fd02;
      font-size: 20px;
    }
    .modal p {
      font-size: 14px;
      color: #ccc;
      margin: 8px 0;
    }
    .modal .apply-form {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-top: 16px;
    }
    .modal .apply-form select,
    .modal .apply-form input,
    .modal .apply-form textarea {
      padding: 8px;
      border: 1px solid #222;
      border-radius: 6px;
      background: #111315;
      color: #fff;
      font-family: 'Inter', sans-serif;
      font-size: 14px;
    }
    .modal .apply-form select {
      appearance: none;
      background-image: url('data:image/svg+xml;utf8,<svg fill="%23ccc" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>');
      background-repeat: no-repeat;
      background-position: right 8px center;
      background-size: 16px;
    }
    .modal .apply-form textarea {
      resize: vertical;
      min-height: 100px;
    }
    .modal .apply-form button {
      padding: 8px 16px;
      background: #d5fd02;
      color: #080808;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .modal .apply-form button:hover { background: #b8e002; }
    .modal .apply-form .close-button {
      padding: 8px 16px;
      background: #222;
      color: #fff;
      border: 1px solid #444;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      font-size: 14px;
      margin-top: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .modal .apply-form .close-button:hover { background: #333; }

    .scroll-indicator {
      position: absolute;
      bottom: 0;
      left: 0;
      height: 4px;
      background: #d5fd02;
      transition: width .3s;
      z-index: 2;
    }
  </style>
</head>
<body>
  <div id="tsparticles"></div>

  <div class="menu-top">
    <img class="logo" src="https://i.postimg.cc/90gRT1n1/Frame-2.png" alt="TMA Logo" />
  </div>

  <div class="carousel">
    <a href="https://traff.com/intervju/kto-takoi-ka-owner-kompanii/?utm_source=abc" target="_blank" class="active">
      <img src="https://i.postimg.cc/yNL8QJ8S/owner-02-3.jpg" alt="Тихон" />
    </a>
    <a href="https://telegra.ph/SCAM-kejs-ot-AMERIOBET-hronologiya-prufy-i-dolg-na-90-000-03-10" target="_blank">
      <img src="https://i.postimg.cc/bJqQWjv5/actual-list.jpg" alt="SCAM кейс" />
    </a>
    <a href="https://www.instagram.com/reel/DKHZPnYtjQD/?igsh=1234567890" target="_blank">
      <img src="https://i.postimg.cc/Z57qjBRv/feat-mac.jpg" alt="мак" />
    </a>
    <div class="hot"></div>
    <div class="carousel-dots">
      <div class="dot active"></div>
      <div class="dot"></div>
      <div class="dot"></div>
    </div>
  </div>

  <nav class="menu">
    <ul>
      <li class="menu-item active" data-section="home">Главная</li>
      <li class="menu-item" data-section="articles">Статьи</li>
      <li class="menu-item" data-section="cases">Кейсы</li>
      <li class="menu-item" data-section="vacancies">Вакансии</li>
      <li class="menu-item" data-section="offers">Офферы</li>
    </ul>
  </nav>

  <section id="home" class="section active">
    <h2 class="section-title">АКТУАЛЬНОЕ</h2>
    <div class="actual-list-container">
      <ul class="actual-list">
        <li class="actual-item" data-aos="fade-up" data-aos-delay="100">
          <a class="card" href="https://cpalenta.ru/keys-130-000-za-2-mesyatsa-s-aso-v-brazilii-na-privatnom-offere-thelimitedclub/" target="_blank" data-id="actual_1" data-title="Гемблинг кейс: $130 000+">
            <img src="https://i.postimg.cc/7PGWRRNZ/130k.jpg" alt="Гемблинг кейс" />
            <div class="text-overlay">
              <strong>Гемблинг кейс</strong>
              <p></p>
            </div>
          </a>
        </li>
        <li class="actual-item" data-aos="fade-up" data-aos-delay="100">
          <a class="card" href="https://telegra.ph/SCAM-kejs-ot-AMERIOBET-hronologiya-prufy-i-dolg-na-90-000-03-18" target="_blank" data-id="actual_2" data-title="SCAM кейс от AMERIO.BET">
            <img src="https://i.postimg.cc/X7KQS6B4/scam.jpg" alt="SCAM кейс" />
            <div class="text-overlay">
              <strong>SCAM от AMERIO.BET</strong>
              <p></p>
            </div>
          </a>
        </li>
        <li class="actual-item" data-aos="fade-up" data-aos-delay="100">
          <a class="card" href="https://telegra.ph/Kak-podnyat-kachestvo-trafika-v-gemblinge-04-09" target="_blank" data-id="actual_3" data-title="Качество трафика в гемблинге">
            <img src="https://i.postimg.cc/hjQFNVwD/photo-2025-05-14-20-01-19.jpg" alt="Статья" />
            <div class="text-overlay">
              <strong>Качество трафика</strong>
              <p></p>
            </div>
          </a>
        </li>
        <li class="actual-item" data-aos="fade-up" data-aos-delay="100">
          <a class="card" href="https://t.me/zakacreator" target="_blank" data-id="actual_4" data-title="Вакансия: Трафик менеджер">
            <img src="https://i.postimg.cc/YSG4qP0S/traffic-manager.jpg" alt="Вакансия" />
            <div class="text-overlay">
              <strong>Вакансия</strong>
              <p></p>
            </div>
          </a>
        </li>
      </ul>
    </div>
    <h2 class="section-title">КОМАНДА</h2>
    <div class="team-carousel">
      <ul class="team-list">
        <li class="team-item" data-aos="fade-up" data-aos-delay="100">
          <a href="https://t.me/Evgenii_Limited" target="_blank">
            <img src="https://i.postimg.cc/yN5SkL2P/3.webp" alt="Evgenii" />
            <strong>Evgenii Limited</strong>
            <p>Co-owner</p>
          </a>
        </li>
        <li class="team-item" data-aos="fade-up" data-aos-delay="100">
          <a href="https://t.me/t_limited" target="_blank">
            <img src="https://i.postimg.cc/KjgCWLjQ/4.webp" alt="Tikhon" />
            <strong>Tikhon Limited</strong>
            <p>Co-owner</p>
          </a>
        </li>
        <li class="team-item" data-aos="fade-up" data-aos-delay="100">
          <a href="https://t.me/Denis_limited" target="_blank">
            <img src="https://i.postimg.cc/GmQ3z0Zt/6-new.webp" alt="Denis" />
            <strong>Denis Limited</strong>
            <p>Head of Affiliate</p>
          </a>
        </li>
        <li class="team-item" data-aos="fade-up" data-aos-delay="100">
          <a href="https://t.me/sasha_limited" target="_blank">
            <img src="https://i.postimg.cc/gkyGkFcs/2.webp" alt="Aleksandra" />
            <strong>Aleksandra Limited</strong>
            <p>Head of Sales</p>
          </a>
        </li>
        <li class="team-item" data-aos="fade-up" data-aos-delay="100">
          <a href="https://t.me/ksu_limited" target="_blank">
            <img src="https://i.postimg.cc/SxDqC6Mz/1.webp" alt="Ksenia" />
            <strong>Ksenia Limited</strong>
            <p>Team Lead Affiliate Manager</p>
          </a>
        </li>
        <li class="team-item" data-aos="fade-up" data-aos-delay="100">
          <a href="https://t.me/katerinaHR_limited" target="_blank">
            <img src="https://i.postimg.cc/hGvnrXLZ/7.jpg" alt="Katerina" />
            <strong>Katerina Limited</strong>
            <p>HRD</p>
          </a>
        </li>
        <li class="team-item" data-aos="fade-up" data-aos-delay="100">
          <a href="https://t.me/Alexandr_limited" target="_blank">
            <img src="https://i.postimg.cc/yNGHr7n1/5-new.webp" alt="Alexander" />
            <strong>Alexander Limited</strong>
            <p>Связь по PR и маркетингу</p>
          </a>
        </li>
      </ul>
    </div>
  </section>

  <section id="articles" class="section">
    <h2 class="section-title">СТАТЬИ</h2>
    <div class="grid">
      <a class="card" href="https://telegra.ph/Kak-podnyat-kachestvo-trafika-v-gemblinge-neskolko-prakticheskih-mehanik-04-09" target="_blank" data-aos="fade-up" data-aos-delay="100">
        <img src="https://i.postimg.cc/JzZmWnct/quality.jpg" alt="Статья 1" />
        <div class="text-overlay">
          <strong>Качество трафика</strong>
          <p>Несколько практических механик</p>
        </div>
      </a>
      <a class="card" href="https://www.instagram.com/p/DCOei_ItMsf/?igsh=YzFudTVhbGlteGJr" target="_blank" data-aos="fade-up" data-aos-delay="100">
        <img src="https://i.postimg.cc/63LfsdTz/partners.jpg" alt="Отзывы" />
        <div class="text-overlay">
          <strong>Отзывы партнеров</strong>
          <p>Наш опыт работы</p>
        </div>
      </a>
      <a class="card" href="https://traffhub.media/articles/gambling/nyuansy-vybora-gembling-offerov/" target="_blank" data-aos="fade-up" data-aos-delay="100">
        <img src="https://i.postimg.cc/q77T6LH6/offer.jpg" alt="Оффер" />
        <div class="text-overlay">
          <strong>Нюансы выбора офферов</strong>
          <p>Советы по гемблингу</p>
        </div>
      </a>
      <a class="card" href="https://traff.com/intervju/kto-takoi-ka-owner-kompanii/?utm_source=abc" target="_blank" data-aos="fade-up" data-aos-delay="100">
        <img src="https://i.postimg.cc/gcKrhgfN/owner-01-3.jpg" alt="Тихон" />
        <div class="text-overlay">
          <strong>Кто такой Co-owner</strong>
          <p>Интервью с командой</p>
        </div>
      </a>
    </div>
  </section>

  <section id="cases" class="section">
    <h2 class="section-title">КЕЙСЫ</h2>
    <div class="grid">
      <a class="card" href="https://cpalenta.ru/keys-130-000-za-2-mesyatsa-s-aso-v-brazilii-na-privatnom-offere-thelimitedclub/" target="_blank" data-aos="fade-up" data-aos-delay="100">
        <img src="https://i.postimg.cc/7PGWRRNZ/130k.jpg" alt="Гемблинг кейс" />
        <div class="text-overlay">
          <strong>Гемблинг кейс: $130 000+</strong>
          <p>Заработок за 2 месяца</p>
        </div>
      </a>
      <a class="card" href="https://telegra.ph/SCAM-kejs-ot-AMERIOBET-hronologiya-prufy-i-dolg-na-90-000-03-18" target="_blank" data-aos="fade-up" data-aos-delay="100">
        <img src="https://i.postimg.cc/X7KQS6B4/scam.jpg" alt="SCAM кейс" />
        <div class="text-overlay">
          <strong>SCAM кейс от AMERIO.BET</strong>
          <p>Хронология и пруфы</p>
        </div>
      </a>
    </div>
  </section>

  <section id="vacancies" class="section">
    <h2 class="section-title">ВАКАНСИИ</h2>
    <div class="grid">
      <div class="promo-card" data-vacancy-id="tlc_promo" data-aos="fade-up" data-aos-delay="100">
        Больше предложений
      </div>
      <div class="card" data-vacancy-id="smm1" data-aos="fade-up" data-aos-delay="100">
        <strong>SMM-менеджер</strong>
        <p>Опыт: от 1 года</p>
        <p>Формат: Удалённо</p>
        <p>Зарплата: от 80 000 RUB</p>
      </div>
      <div class="card" data-vacancy-id="smm2" data-aos="fade-up" data-aos-delay="100">
        <strong>SMM-менеджер (Senior)</strong>
        <p>Опыт: от 3 лет</p>
        <p>Формат: Удалённо</p>
        <p>Зарплата: от 120 000 RUB</p>
      </div>
    </div>
  </section>

  <section id="offers" class="section">
    <h2 class="section-title">ОФФЕРЫ</h2>
    <div class="grid">
      <a class="card" href="https://t.me" target="_blank" data-aos="fade-up" data-aos-delay="100">
        <strong>Источник: ASO</strong>
        <p>ГЕО: FR</p>
        <p>Ставка: 160 EUR</p>
        <p>Mindep: 10 EUR</p>
      </a>
      <a class="card" href="https://t.me" target="_blank" data-aos="fade-up" data-aos-delay="100">
        <strong>Источник: PPC</strong>
        <p>ГЕО: DE</p>
        <p>Ставка: 200 EUR</p>
        <p>Mindep: 15 EUR</p>
      </a>
      <a class="card" href="https://t.me" target="_blank" data-aos="fade-up" data-aos-delay="100">
        <strong>Источник: SEO</strong>
        <p>ГЕО: UK</p>
        <p>Ставка: 180 EUR</p>
        <p>Mindep: 20 EUR</p>
      </a>
    </div>
  </section>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tsparticles@2.12.0/tsparticles.bundle.min.js"></script>
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script>
    AOS.init({
      duration: 800,
      once: true,
      offset: 100
    });
    window.addEventListener('load', () => {
      AOS.refresh();
      console.log('AOS refreshed');
    });

    if (typeof tsParticles !== 'undefined') {
      tsParticles.load("tsparticles", {
        fpsLimit: 60,
        particles: {
          number: { value: 100, density: { enable: true, value_area: 800 } },
          color: { value: "#d5fd02" },
          shape: { type: "circle" },
          opacity: { value: 0.5, random: true },
          size: { value: 3, random: { enable: true, minimumValue: 1 } },
          links: { enable: false },
          move: {
            enable: true,
            speed: 0.5,
            direction: "none",
            random: true,
            outModes: { default: "out" }
          }
        },
        interactivity: { events: { onHover: { enable: false } }, resize: { enable: true } },
        retina_detect: true
      }).then(() => console.log('tsParticles loaded')).catch(err => console.error('tsParticles error:', err));
    } else {
      console.error('tsParticles not loaded');
    }

    function updateScrollIndicator(list) {
      const indicator = list.parentElement.querySelector('.scroll-indicator');
      if (!indicator) return;
      const maxScroll = list.scrollWidth - list.clientWidth;
      const scrollPercent = list.scrollLeft / maxScroll;
      indicator.style.width = `${scrollPercent * 100}%`;
    }

    document.querySelectorAll('.team-list, .actual-list').forEach(list => {
      const indicator = document.createElement('div');
      indicator.className = 'scroll-indicator';
      list.parentElement.appendChild(indicator);
      list.addEventListener('scroll', () => updateScrollIndicator(list));
      updateScrollIndicator(list);
    });

    const tg = window.Telegram.WebApp;
    tg.expand();

    let user_id = null, username = null, first_name = null, last_name = null;
    if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
      ({ id: user_id, username, first_name, last_name } = tg.initDataUnsafe.user);
    }

    const SHEET_ENDPOINT = 'https://script.google.com/macros/s/AKfycbxRK9cnnKCBM4AypS_cPFlYWkowUfBRiwFHbHYBcWNREHuy25nx1JvUVatPtVk1BzU_Mw/exec';

    function generateUUID() {
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
        const r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
      });
    }

    function sendToSheet(data) {
      console.log('Sending to sheet:', data);
      fetch(SHEET_ENDPOINT, {
        method: 'POST',
        mode: 'no-cors',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      }).catch(error => console.error('Fetch error:', error));
    }

    function trackEvent(eventName, additional = {}) {
      sendToSheet({
        event: eventName,
        user_id,
        username,
        first_name,
        last_name,
        userAgent: navigator.userAgent,
        additional
      });
    }

    trackEvent('webapp_open');

    document.querySelectorAll('.menu-item').forEach(item => {
      item.addEventListener('click', () => {
        trackEvent('nav_click', { section: item.dataset.section });
        document.querySelectorAll('.section').forEach(sec => {
          sec.classList.toggle('active', sec.id === item.dataset.section);
          console.log(`Section ${sec.id} active: ${sec.classList.contains('active')}`);
        });
        document.querySelectorAll('.menu-item').forEach(i => i.classList.toggle('active', i === item));
        window.scrollTo(0, 0);
      });
    });

    document.querySelectorAll('.card, .team-item a').forEach(card => {
      card.addEventListener('click', (e) => {
        if (e.target.closest('.apply-form') || card.closest('#vacancies')) return;
        const title = card.querySelector('strong')?.innerText || 'Unknown';
        trackEvent('card_click', { title });
      });
    });

    document.querySelectorAll('.carousel a').forEach(slide => {
      slide.addEventListener('click', () => {
        const alt = slide.querySelector('img')?.getAttribute('alt') || 'Unknown';
        trackEvent('carousel_click', { slide: alt });
      });
    });

    document.querySelectorAll('.carousel-dots .dot').forEach((dot, i) => {
      dot.addEventListener('click', () => {
        trackEvent('carousel_dot_click', { slideIndex: i });
        document.querySelectorAll('.carousel a').forEach((slide, index) => {
          slide.classList.toggle('active', index === i);
        });
        document.querySelectorAll('.carousel-dots .dot').forEach((d, index) => {
          d.classList.toggle('active', index === i);
        });
      });
    });

    const scrollableLists = document.querySelectorAll('.menu ul, .team-list, .actual-list');
    scrollableLists.forEach(list => {
      list.addEventListener('wheel', (e) => {
        e.preventDefault();
        const delta = Math.abs(e.deltaX) > Math.abs(e.deltaY) ? e.deltaX : e.deltaY;
        list.scrollLeft += delta * 2.5;
      });
    });

    const vacancyData = {
      smm1: {
        title: 'SMM-менеджер',
        experience: 'от 1 года',
        format: 'Удалённо',
        salary: 'от 80 000 RUB',
        description: 'Ведение социальных сетей, создание и публикация контента, взаимодействие с аудиторией, разработка SMM-стратегии.',
        requirements: 'Опыт работы в SMM от 1 года, знание инструментов аналитики, креативность, умение работать с Canva или аналогами.'
      },
      smm2: {
        title: 'SMM-менеджер (Senior)',
        experience: 'от 3 лет',
        format: 'Удалённо',
        salary: 'от 120 000 RUB',
        description: 'Разработка и реализация SMM-стратегий, управление командой, работа с крупными бюджетами, анализ эффективности кампаний.',
        requirements: 'Опыт работы в SMM от 3 лет, навыки управления проектами, глубокое знание аналитики и рекламных кабинетов.'
      },
      tlc_promo: {
        title: 'Заполняй анкету быстрее!',
        description: 'The Limited Club Здесь высокие показатели — не цель, а стандарт',
        offers: `
          <strong>Что мы предлагаем:</strong><br>
          1️⃣ доступ к эксклюзивным предложениям на рынке<br>
          2️⃣ Уникальный опыт<br>
          3️⃣ Выход на более частые выплаты<br>
          Все инструменты для успеха от лидеров аффилейт сферы – у тебя под рукой!
        `
      }
    };

    document.querySelectorAll('#vacancies .card, #vacancies .promo-card').forEach(card => {
      card.addEventListener('click', () => {
        const vacancyId = card.dataset.vacancyId;
        const data = vacancyData[vacancyId];
        if (!data) return;
        trackEvent('vacancy_view', { vacancy: data.title });

        const modal = document.createElement('div');
        modal.className = 'modal';
        const renderForm = (position = '') => {
          let formContent = `
            <label>Ваш Telegram (например, @username)</label>
            <input type="text" name="telegram" placeholder="@username" pattern="@[A-Za-z0-9_]{5,}" required>
          `;
          if (vacancyId === 'tlc_promo') {
            if (position === 'Владелец команды') {
              formContent += `
                <label>Каков твой опыт в вертикалях iGaming/Betting/Finance?</label>
                <select name="experience" required>
                  <option value="" disabled selected>Выберите опыт</option>
                  <option value="3+ года">3+ года</option>
                  <option value="1-2 года">1-2 года</option>
                  <option value="6-12 месяцев">6-12 месяцев</option>
                  <option value="менее 6 месяцев">менее 6 месяцев</option>
                </select>
                <label>С каким источником работаешь?</label>
                <select name="source" required>
                  <option value="" disabled selected>Выберите источник</option>
                  <option value="FB">FB</option>
                  <option value="PPC">PPC</option>
                  <option value="ASO">ASO</option>
                  <option value="SEO">SEO</option>
                </select>
                <label>Сколько человек в команде?</label>
                <select name="team_size" required>
                  <option value="" disabled selected>Выберите размер</option>
                  <option value="1-4">1-4</option>
                  <option value="5-9">5-9</option>
                  <option value="10-14">10-14</option>
                  <option value="15+">15+</option>
                </select>
                <label>Каков средний спенд и профит команды в месяц за последние полгода?</label>
                <textarea name="spend_profit" placeholder="Опишите спенд и профит" required></textarea>
                <label>Почему вы решили привлечь инвестиции в свою команду?</label>
                <textarea name="investment_reason" placeholder="Опишите причину" required></textarea>
              `;
            } else if (position === 'Тимлид' || position === 'Медиабаер') {
              formContent += `
                <label>Как тебя зовут?</label>
                <input type="text" name="name" placeholder="Ваше имя" required>
                <label>В каком городе ты живёшь?</label>
                <input type="text" name="city" placeholder="Город" required>
                <label>Каков твой опыт в вертикалях iGaming/Betting/Finance?</label>
                <select name="experience" required>
                  <option value="" disabled selected>Выберите опыт</option>
                  <option value="3+ года">3+ года</option>
                  <option value="1-2 года">1-2 года</option>
                  <option value="6-12 месяцев">6-12 месяцев</option>
                  <option value="менее 6 месяцев">менее 6 месяцев</option>
                </select>
                <label>Твой источник?</label>
                <select name="source" required>
                  <option value="" disabled selected>Выберите источник</option>
                  <option value="FB">FB</option>
                  <option value="PPC">PPC</option>
                  <option value="ASO">ASO</option>
                  <option value="SEO">SEO</option>
                </select>
                <label>Какой бюджет в среднем отливаешь?</label>
                <select name="budget" required>
                  <option value="" disabled selected>Выберите бюджет</option>
                  <option value="Менее $1,000">$1,000</option>
                  <option value="$1,000-$5,000">$1,000-$5,000</option>
                  <option value="$5,000-$10,000">$5,000-$10,000</option>
                </select>
                <label>Расскажи о своём опыте</label>
                <textarea name="actual" placeholder="Оформление кейса или резюме будет плюсом ✌️" required></textarea>
              `;
            } else {
              formContent += `
                <label>На какую роль ты претендуешь?</label>
                <select name="position" required>
                  <option value="" disabled selected>Выбери роль</option>
                  <option value="Владелец команды">Владелец команды</option>
                  <option value="Тимлид">Тимлид</option>
                  <option value="Медиабаер">Медиабаер</option>
                </select>
                <label>Как тебя зовут?</label>
                <input type="text" name="name" placeholder="Ваше имя" required>
                <label>В каком городе ты живёшь?</label>
                <input type="text" name="city" placeholder="Город" required>
                <label>Какой у тебя опыт в вертикалях iGaming/Betting/Finance?</label>
                <select name="experience" required>
                  <option value="" disabled selected>Выберите опыт</option>
                  <option value="3+ года">3+ года</option>
                  <option value="1-2 года">1-2 года</option>
                  <option value="6-12 месяцев">6-12 месяцев</option>
                  <option value="менее 6 месяцев">менее 6 месяцев</option>
                </select>
                <label>Твой источник?</label>
                <select name="source" required>
                  <option value="" disabled selected>Выбери источник</option>
                  <option value="FB">FB</option>
                  <option value="PPC">PPC</option>
                  <option value="ASO">ASO</option>
                  <option value="SEO">SEO</option>
                </select>
                <label>Какой бюджет в среднем ты используешь?</label>
                <select name="budget" required>
                  <option value="" disabled selected>Выбери бюджет</option>
                  <option value="Менее $1,000">$1,000</option>
                  <option value="$1,000-$5,000">$1,000-$5,000</option>
                  <option value="$5,000-$10,000">$5,000-$10,000</option>
                </select>
                <label>Расскажи о своём опыте</label>
                <textarea name="actual" placeholder="Оформление кейса или резюме будет плюсом ✌️" required></textarea>
              `;
            }
          } else {
            formContent += `
              <label>Как тебя зовут?</label>
              <input type="text" name="name" placeholder="Ваше имя" required>
              <label>В каком городе ты живёшь?</label>
              <input type="text" name="city" placeholder="Город" required>
              <label>Расскажи о своём опыте</label>
              <textarea name="experience" placeholder="Опиши свой опыт" required></textarea>
              <label>Ссылка на резюме</label>
              <input type="url" name="resume" placeholder="https://">
            `;
          }
          return formContent;
        };

        modal.innerHTML = `
          <h3>${data.title}</h3>
          <p>${data.description || ''}</p>
          <p>${data.offers || ''}</p>
          <form class="apply-form">
            ${renderForm()}
            <button type="submit"><i class="fas fa-paper-plane"></i> Отправить</button>
            <button type="button" class="close-button"><i class="fas fa-times"></i> Закрыть</button>
          </form>
        `;
        document.body.appendChild(modal);

        setTimeout(() => modal.classList.add('active'), 10);

        const positionSelect = modal.querySelector('select[name="position"]');
        if (positionSelect) {
          positionSelect.addEventListener('change', () => {
            const newFormContent = renderForm(positionSelect.value);
            const form = modal.querySelector('.apply-form');
            form.innerHTML = `
              ${newFormContent}
              <button type="submit"><i class="fas fa-paper-plane"></i> Отправить</button>
              <button type="button" class="close-button"><i class="fas fa-times"></i> Закрыть</button>
            `;
            form.querySelector('.close-button').addEventListener('click', () => {
              modal.classList.remove('active');
              setTimeout(() => modal.remove(), 300);
            });
          });
        }

        modal.querySelector('.close-button').addEventListener('click', () => {
          modal.classList.remove('active');
          setTimeout(() => modal.remove(), 300);
        });

        modal.querySelector('.apply-form').addEventListener('submit', (e) => {
          e.preventDefault();
          const formData = new FormData(e.target);
          const telegram = formData.get('telegram');
          if (!telegram || !telegram.startsWith('@')) {
            tg.showPopup({
              title: 'Ошибка',
              message: 'Telegram должен начинаться с @',
              buttons: [{ type: 'ok' }]
            });
            return;
          }
          const response_id = generateUUID();
          const additional = {
            id: vacancyId,
            title: data.title,
            response_id
          };
          for (const [key, value] of formData.entries()) {
            additional[key] = value;
          }
          console.log('Form data:', additional);
          const eventData = {
            event: 'vacancy_apply',
            user_id,
            username,
            first_name,
            last_name,
            timestamp: new Date().toISOString(),
            additional
          };
          sendToSheet(eventData);
          tg.showPopup({
            title: 'Успех!',
            message: 'Ваш отклик отправлен! Мы свяжемся с вами через Telegram. Пожалуйста, начни с нашего бота @Bot, отправляя /start.',
            buttons: [{ type: 'ok' }]
          });
          modal.classList.remove('active');
          setTimeout(() => modal.remove(), 300);
        });
      });
    });

    function startCarousel() {
      const slides = document.querySelectorAll('.carousel a');
      const dots = document.querySelectorAll('.carousel-dots .dot');
      let currentIndex = 0;
      function showSlide(index) {
        slides.forEach((slide, i) => {
          slide.classList.toggle('active', i === index);
        });
        dots.forEach((dot, i) => {
          dot.classList.toggle('active', i === index);
        });
        currentIndex = index;
      }

      function nextSlide() {
        currentIndex = (currentIndex + 1) % slides.length;
        showSlide(currentIndex);
      }

      setInterval(nextSlide, 3000);
      showSlide(currentIndex);
    }

    startCarousel();
  </script>
</body>
</html>
